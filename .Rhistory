usethis::use_description()
usethis::use_vignette()
usethis::use_vignette(MbQTL_Vignette.RMD)
usethis::use_vignette(./vignettes/MbQTL_Vignette.RMD)
usethis::use_vignette("MbQTL_Vignette")
library(dplyr)
library(roxygen2)
devtools::document()
devtools::document()
library(mbQTL)
microbeAbund<-read.table("data-raw/Taxa_table_MVP_cor.txt",sep="\t",row.names = 1, header=TRUE)
SnpFile<-read.table("data-raw/SNP_table_MVP_cor.txt",sep="\t",row.names = 1, header=TRUE)
CovFile<-read.table("data-raw/covariates.txt",sep="\t",row.names = 1, header=TRUE)
usethis::use_data(microbeAbund,SnpFile,CovFile, overwrite = T)
library(mbQTL)
mbQTL::SnpFile
knitr::opts_chunk$set(
dpi=300,
warning = FALSE,
collapse = TRUE,
error = FALSE,
comment = "#>",
echo=TRUE
)
library(mbQTL)
data("SnpFile")
data("microbeAbund")
data("CovFile")
doctype <- opts_knit$get("rmarkdown.pandoc.to")
knitr::opts_chunk$set(
dpi=300,
warning = FALSE,
collapse = TRUE,
error = FALSE,
comment = "#>",
echo=TRUE
)
library(mbQTL)
data("SnpFile")
data("microbeAbund")
data("CovFile")
doctype <- knitr::opts_knit$get("rmarkdown.pandoc.to")
knitr::opts_chunk$set(
dpi=300,
warning = FALSE,
collapse = TRUE,
error = FALSE,
comment = "#>",
echo=TRUE
)
library(mbQTL)
library(tidyr)
data("SnpFile")
data("microbeAbund")
data("CovFile")
doctype <- knitr::opts_knit$get("rmarkdown.pandoc.to")
library(mbQTL)
knitr::opts_chunk$set(
dpi=300,
warning = FALSE,
collapse = TRUE,
error = FALSE,
comment = "#>",
echo=TRUE
)
library(mbQTL)
library(tidyr)
data("SnpFile")
data("microbeAbund")
data("CovFile")
doctype <- knitr::opts_knit$get("rmarkdown.pandoc.to")
correlationMicrobes<-coringTaxa(microbeAbund)
#Estimate taxa SNP - taxa correlation and estimate R2 (To what extent variance in one taxa explains the variance in snp)
one_rs_id<-all_to_all_product(SnpFile,"chr1.171282963_T") #For a specific snp
correlationMicrobes<-coringTaxa(microbeAbund)
#Estimate taxa SNP - taxa correlation and estimate R2 (To what extent variance in one taxa explains the variance in snp)
one_rs_id<-all_to_all_product(SnpFile,microbeAbund,"chr1.171282963_T") #For a specific snp
#Now estimate rho vale
for_all_rsids<-all_to_all_product(SnpFile) #for all snps
correlationMicrobes<-coringTaxa(microbeAbund)
#Estimate taxa SNP - taxa correlation and estimate R2 (To what extent variance in one taxa explains the variance in snp)
one_rs_id<-all_to_all_product(SnpFile,microbeAbund,"chr1.171282963_T") #For a specific snp
#Now estimate rho vale
for_all_rsids<-all_to_all_product(SnpFile,microbeAbund) #for all snps
#Estimate rho value for SNP - taxa relationship
taxa_SNP_Cor<-TaxaSnpCor(for_all_rsids,correlationMicrobes) #Estimate rho for all combinations of snp-taxa and taxa-taxa relationships
taxa_SNP_Cor_lim<-TaxaSnpCor(for_all_rsids,correlationMicrobes,probs = c(0.0001, 0.9999))
# estimate for the top rho values produced
#Draw heatmap of rho estimates
mbQtlCorHeatmap(taxa_SNP_Cor_lim,fontsize_col=4,fontsize_row=4)
library(mbQTL)
knitr::opts_chunk$set(
dpi=300,
warning = FALSE,
collapse = TRUE,
error = FALSE,
comment = "#>",
echo=TRUE
)
library(mbQTL)
library(tidyr)
data("SnpFile")
data("microbeAbund")
data("CovFile")
doctype <- knitr::opts_knit$get("rmarkdown.pandoc.to")
correlationMicrobes<-coringTaxa(microbeAbund)
#Estimate taxa SNP - taxa correlation and estimate R2 (To what extent variance in one taxa explains the variance in snp)
one_rs_id<-all_to_all_product(SnpFile,microbeAbund,"chr1.171282963_T") #For a specific snp
#Now estimate rho vale
for_all_rsids<-all_to_all_product(SnpFile,microbeAbund) #for all snps
#Estimate rho value for SNP - taxa relationship
taxa_SNP_Cor<-TaxaSnpCor(for_all_rsids,correlationMicrobes) #Estimate rho for all combinations of snp-taxa and taxa-taxa relationships
taxa_SNP_Cor_lim<-TaxaSnpCor(for_all_rsids,correlationMicrobes,probs = c(0.0001, 0.9999))
# estimate for the top rho values produced
#Draw heatmap of rho estimates
mbQtlCorHeatmap(taxa_SNP_Cor_lim,fontsize_col=4,fontsize_row=4)
?tidy
tidy
library(mbQTL)
??tidy
library(mbQTL)
library(mbQTL)
library(mbQTL)
library(mbQTL)
knitr::opts_chunk$set(
dpi=300,
warning = FALSE,
collapse = TRUE,
error = FALSE,
comment = "#>",
echo=TRUE
)
library(mbQTL)
library(tidyr)
data("SnpFile")
data("microbeAbund")
data("CovFile")
doctype <- knitr::opts_knit$get("rmarkdown.pandoc.to")
Logit_plot
Logit_plot<-LogitPlotSnpTaxa(microbeAbund, SnpFile, selectmicrobe = "Neisseria", rsID="chr2.241072116_A", ref="GG", alt="AA",het="AG")
Logit_plot
#Create a barplot with the specific rsID, and microbe of interest, including the genotype information for the reference versus alternate versus hetrozygous alleles and and presence absecence of microbe of interest.
Logit_plot<-LogitPlotSnpTaxa(microbeAbund, SnpFile, selectmicrobe = "Neisseria", rsID="chr2.241072116_A", ref="GG", alt="AA",het="AG")
Logit_plot
#Create a barplot with the specific rsID, and microbe of interest, including the genotype information for the reference versus alternate versus hetrozygous alleles and and presence absecence of microbe of interest.
Logit_plot<-LogitPlotSnpTaxa(microbeAbund, SnpFile, selectmicrobe = "Neisseria", rsID="chr2.241072116_A", ref="GG", alt="AA",het="AG")
Logit_plot
##Draw heatmap of rho estimates "taxa_SNP_Cor_lim" is the output of TaxaSnpCor(). You can use other pheatmap settings for extra annotation
mbQtlCorHeatmap(taxa_SNP_Cor_lim,fontsize_col=4,fontsize_row=4.5)
##Draw heatmap of rho estimates "taxa_SNP_Cor_lim" is the output of TaxaSnpCor(). You can use other pheatmap settings for extra annotation
mbQtlCorHeatmap(taxa_SNP_Cor_lim,fontsize_col=4,fontsize_row=6)
##Draw heatmap of rho estimates "taxa_SNP_Cor_lim" is the output of TaxaSnpCor(). You can use other pheatmap settings for extra annotation
mbQtlCorHeatmap(taxa_SNP_Cor_lim,fontsize_col=5,fontsize_row=7)
##Create a histogram of P values across all samples
Hist_Pvalue_LM(LinearAnalysisTaxaSNP)
#perform linear regression analysis between taxa and snps across samples and
#produce a dataframe of results.
LinearAnalysisTaxaSNP<-linearTaxaSnp(microbeAbund,SnpFile,Covariate=CovFile)
##Create a histogram of P values across all samples
Hist_Pvalue_LM(LinearAnalysisTaxaSNP)
#Create a QQPlot of expected versus estimated P value
qqPlotLm(microbeAbund,SnpFile,Covariate=CovFile)
knitr::opts_chunk$set(
dpi=300,
warning = FALSE,
collapse = TRUE,
error = FALSE,
comment = "#>",
echo=TRUE
)
library(mbQTL)
library(tidyr)
data("SnpFile")
data("microbeAbund")
data("CovFile")
doctype <- knitr::opts_knit$get("rmarkdown.pandoc.to")
#Create a barplot with the specific rsID, and microbe of interest, including the genotype information for the reference versus alternate versus hetrozygous alleles and and presence absecence of microbe of interest.
Logit_plot<-LogitPlotSnpTaxa(microbeAbund, SnpFile, selectmicrobe = "Neisseria", rsID="chr2.241072116_A", ref="GG", alt="AA",het="AG")
Logit_plot
